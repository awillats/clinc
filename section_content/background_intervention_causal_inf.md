<!-- NOTE: starts to be intervention-y... maybe this section shouldn't exist if we're not discussing time-series estimation in depth -->
A range of mathematical and practical challenges make it difficult to determine these causal relationships. In studies that rely only observational data, it is often impossible to determine whether observed patterns of activity are caused by known and controlled inputs, or whether they are instead spurious connections generated by recurrent activity, indirect relationships, or unobserved "confounders." It is generally understood that moving from experiments involving passive observation to more complex levels of intervention allows experimenters to better tackle challenges to circuit identification. However, while chemical and surgical lesion experiments have historically been employed to remove the influence of possible confounds, they are likely to dramatically disrupt circuits from their typical functions, making conclusions about underlying causal structure drawn from these experiments unlikely to hold in naturalistic settings [@chicharro2012when]. 

![](/figures/core_figure_sketches/figure1_sketch.png "role of interventions")

> **Figure INTRO: Roles interventions have played in understanding structure and function in neuroscience.** (A) *Passive observation* involves recording signals without stimulating the brain. In this example, observational data is used to identify patients suffering from absence seizures [@smith2005eeg]. (B) *Open-loop stimulation* involves recording activity in the brain while perturbing a region with a known input signal. Using systematic *open-loop stimulation experiments*, Penfield uncovered the spatial organization of how senses and movement are mapped in the cortex [@penfield1937somatic;@penfield1950cerebral]. (C) *Closed-loop control* uses feedback control to precisely specify activity in certain brain regions regardless of activity in other regions. Using closed-loop control (voltage clamp), Hodgkin, Huxley, and Katz were able to dissect the recurrent ion channel dynamics of the action potential by functionally lesioning the impact of individual ion channels [@cole1949dynamic; @hodgkin1949effect; @hodgkin1952measurement].

<!-- NOTE: refs from thesis, esp. __background_from_th.md -->
**The role of intervention in neuroscience**
Despite these challenges, neuroscientists have made progress in understanding the brain through various approaches. One way in which these approaches differ is in terms of their use of recording and stimulation (`Fig. INTRO`). Recording from the brain **(passive observation)** and analyzing those data for patterns can tell us which regions may be involved in a particular behavior. For instance, electroencepahlograms (EEG) can help reveal the hidden storm of electrical activity that underlies epileptic seizures, providing clues as to its origin and classifying its type [@smith2005eeg]. In addition, perturbing the brain through stimulation **(open-loop intervention)** can help understand whether activity in one region is sufficient to produce some downstream effect. For instance, Wilder Penfield stimulated different regions of the brain with electricity in order to assess safe sites for surgical treatment of epilepsy. Through these systematic stimulation experiments, he was able to uncover the spatial organization of how senses and movement are mapped in the cortex [@penfield1937somatic; @penfield1950cerebral]. Similarly Hubel and Wiesel delivered precise patterns of sensory stimulation in the form of patterns of light in order to characterize the function of the visual system [@hubel1959receptive; @hubel1962receptive]. These open-loop approaches are especially adept at demonstrating cause and effect in "feedforward" chains of information processing within the brain.

However, in many circuits and at several scales, the brain is connected back on itself in reciprocal loops. In these systems, the effect of stimulation can reverberate through a circuit blurring the direction of cause and effect. In addition, unobserved sources of variability mean responses of the brain to the identical inputs can be context dependent and differ from trial to trial. For such systems, **closed-loop interventions** - that is, adapting inputs to a system based on measurements in order to drive the system's state toward a target - have proved invaluable in isolating function and removing outside disturbances. Hodgkin, Huxley, and Katz used a closed-loop technique, voltage clamp, to dissect the recurrent ion channel dynamics of the action potential by functionally lesioning the impact of individual ion channels (`Fig. INTRO`, @cole1949dynamic; @hodgkin1949effect; @hodgkin1952measurement). Subsequently, dynamic-clamp experiments have used precise intracellular measurements and mathematical models to predict currents which allow for causally manipulating ongoing dynamics [@sharp1993dynamic; @prinz2004dynamic]. 

In both of these settings, a key advantage of closed-loop control is that a tightly coupled set of factors are simplified by holding some constant and thereby removing their effect on the variables being studied. An alternative approach, used successfully throughout neuroscience is to lesion (e.g. chemically or surgically) inputs from other regions. While chemical and surgical lesion experiments have historically been employed to remove the influence of possible confounds, they are likely to dramatically disrupt circuits from their typical functions, making conclusions about underlying causal structure drawn from these experiments unlikely to hold in naturalistic settings [@chicharro2012when; @wolff2018promise; @vaidya2019lesion; @valero-cabre2020perturbationdriven].
<!-- NOTE: cut -- Closed-loop control allows for both simplifying identification by reversibly severing inputs, while also potentially maintaining other aspects of a circuits natural context (such as mean activity levels and firing rates), allowing for precise identification in a relevant operating regime. -->

<!-- NOTE: see also:
/sketches_and_notation/intro-background/__background_from_th.md
/sketches_and_notation/intro-background/__background_control_prop.md
/sketches_and_notation/intro-background/background_why_control.md
-->
<!-- NOTE: prior draft archived at /section_content/spiking_draft/spiking_background_intervention_causal_inf.md -->

**The role of intervention in causal inference**
Data collected from experimental settings can provide more inferential power than observational data alone. For example, consider an experimentalist who is considering multiple causal hypotheses for two nodes under study, $x$ and $y$: the hypothesis that $x$ is driving $y$, the hypothesis that $y$ is driving $x$, or the hypothesis that the two variables are being independently driven by a hidden confounder. Observational data revealing that $x$ and $y$ produce correlated time-series data is equally consistent with each of these three causal hypotheses, providing the experimentalist with no inferential power. Experimentally manipulating $x$ and observing the output of $y$, however, allows the scientist to begin to establish which causal interaction pattern is at work. Consistent with intuition from neuroscience literature, a rich theoretical literature has described the central role of interventions in inferring causal structure from data [@pearl2009causality; @eberhardt2007interventions].

The inferential power of interventions is depends on *where* stimulation is applied: interventions on some portions of a system may provide more information about the system's causal structure than interventions in other areas. And interventions are also more valuable when they more effectively set the state of the system: "perfect" closed-loop control, which completely severs a node's activity from its inputs, are often more informative than "soft" interventions that only partially control a part of the system [@eberhardt2007interventions].

**The challenge of designing intervention experiments.**
In experimental neuroscience settings, experimenters are faced with deciding between interventions that differ in both location and effectiveness. For example, stimulation can often only be applied to certain regions of the brain. And while experimenters may be able to exactly manipulate activity in some parts of the brain using closed-loop control, in other locations it may only be possible to apply weaker forms of intervention that perturb a region but do not manipulate its activity exactly to a desired state. In Section [# impact of intervention](REF-SECTION-HERE), we compare the effectiveness of open-loop, closed-loop, and partially-effective closed-loop control.

Although algorithms designed to choose optimal interventions are often designed for simple models with strong assumptions,[^more] they provide intuition that can aid practitioners seeking to design real-world experiments that provide as much scientific insight as possible. Importantly, the informativeness of interventions is often independent of the algorithm used to infer causal connections, meaning that certain interventions can reveal portions of a circuit's causal structure that would be impossible for *any* algorithm to infer from only observational data [@das2020systematic]. We similarly expect the results we demonstrate in this paper to both inform experimentalists and open avenues for further research.

<!-- TODO: make sure this @das2020systematic citation is in the right place) -->

[^more]: These assumptions are typically on properties such as the types of functional relationships that exist in circuits, the visibility and structure of confounding relationships, and noise statistics.

<!-- practitioners seeking to design real-world experiments that provide as much scientific insight as possible.... if citations needed here, could start by looking for a good high-level reference in either [@ghassami2018budgeted] or [@yang2018characterizing]. (Both of these papers are pretty technical, so likely wouldn't be great citations on their own.) -->
